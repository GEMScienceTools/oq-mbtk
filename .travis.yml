dist: bionic
language: python

cache: pip

python:
 - "3.8"

env:
  - MPLBACKEND=Agg

install:
  - sudo apt update && sudo apt install libspatialindex-dev libpython3.8-dev
  - git clone --depth=1 https://github.com/gem/oq-engine.git &&
    pip -q install -r oq-engine/requirements-py38-linux64.txt -r oq-engine/requirements-extra-py38-linux64.txt && pip install -e oq-engine

script:
  - nosetests -vsx -a '!slow'

notifications:
  email:
    recipients:
      - marco.pagani@globalquakemodel.org
      - michele.simionato@globalquakemodel.org
    on_success: never
    on_failure: always
